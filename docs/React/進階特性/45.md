---
title: React Function Component çš„ç”Ÿå‘½é€±æœŸï¼šå¾ setState åˆ° DOM æ›´æ–°çš„å®Œæ•´è§£æ
description: æ·±å…¥è§£æ React Function Component çš„ç”Ÿå‘½é€±æœŸé‹ä½œæ©Ÿåˆ¶ï¼ŒåŒ…å« Render Phaseã€Commit Phaseã€React Element èˆ‡ DOM Element çš„è½‰æ›éç¨‹èˆ‡ Hooks æ¨¡æ“¬ç”Ÿå‘½é€±æœŸçš„æ–¹æ³•
keywords:
  [
    React,
    Function Component,
    ç”Ÿå‘½é€±æœŸ,
    setState,
    Render Phase,
    Commit Phase,
    React Element,
    DOM Element,
    Hooks,
    Reconciliation,
  ]
---

åœ¨å­¸ç¿’ React çš„éç¨‹ä¸­ï¼Œå¸¸å¸¸æœƒé‡åˆ°ä¸€å€‹ç–‘å•ï¼š**Function Component æ²’æœ‰ç”Ÿå‘½é€±æœŸæ–¹æ³•ï¼Œé‚£å®ƒçš„ setStateã€render phaseã€commit phaseã€React element èˆ‡ DOM element ä¹‹é–“åˆ°åº•æ˜¯å¦‚ä½•é‹ä½œçš„å‘¢ï¼Ÿ**\
é€™ç¯‡æ–‡ç« å°‡å¸¶ä½ ä¸€æ­¥æ­¥é‡æ¸…å®ƒå€‘çš„é—œä¿‚ã€‚

---

## ç”Ÿå‘½é€±æœŸçš„ä¸‰å¤§éšæ®µ

ä¸è«–æ˜¯ Class Component é‚„æ˜¯ Function Componentï¼ŒReact çš„æ›´æ–°æµç¨‹éƒ½å¯ä»¥åˆ†æˆä¸‰å€‹ä¸»è¦éšæ®µï¼š

1. **Mountï¼ˆæ›è¼‰ï¼‰**ï¼šå…ƒä»¶ç¬¬ä¸€æ¬¡è¢«å»ºç«‹ä¸¦æ’å…¥ DOMã€‚

2. **Updateï¼ˆæ›´æ–°ï¼‰**ï¼šstate æˆ– props æ”¹è®Šï¼Œå…ƒä»¶é‡æ–°æ¸²æŸ“ã€‚

3. **Unmountï¼ˆå¸è¼‰ï¼‰**ï¼šå…ƒä»¶è¢«ç§»é™¤ï¼Œæ¸…ç†è³‡æºã€‚

Function Component é›–ç„¶æ²’æœ‰å‚³çµ±çš„ç”Ÿå‘½é€±æœŸæ–¹æ³•ï¼Œä½†å¯ä»¥é€é **Hooks** ä¾†æ¨¡æ“¬é€™äº›è¡Œç‚ºã€‚

---

## React çš„é‹ä½œéšæ®µ

React çš„é‹ä½œæµç¨‹å¯ä»¥åˆ†æˆ **å…©å€‹ä¸»è¦éšæ®µ**ï¼š

1. **Render Phaseï¼ˆæ¸²æŸ“éšæ®µï¼‰**

   - React æœƒå‘¼å« Function Componentï¼Œè¨ˆç®—å‡º **æ–°çš„ React element tree**ã€‚

   - é€™å€‹éšæ®µæ˜¯ç´”è¨ˆç®—ï¼Œä¸æœƒæ“ä½œç€è¦½å™¨ DOMã€‚

   - React æœƒæ¯”å°èˆŠçš„ virtual DOM èˆ‡æ–°çš„ React elementï¼ˆä¹Ÿå°±æ˜¯ Reconciliationï¼‰ã€‚

2. **Commit Phaseï¼ˆæäº¤éšæ®µï¼‰**

   - React æŠŠå·®ç•°å¥—ç”¨åˆ°çœŸå¯¦çš„ DOM elementã€‚

   - é€™æ™‚å€™ç•«é¢æ‰æœƒçœŸæ­£æ›´æ–°ã€‚

   - åŒæ™‚åŸ·è¡Œ `useEffect`ã€`useLayoutEffect` ç­‰å‰¯ä½œç”¨ã€‚

ğŸ‘‰ æ³¨æ„ï¼š

- **åˆæ¬¡æ›è¼‰ï¼ˆMountï¼‰** ä¹Ÿæœƒç¶“æ­· render phase â†’ commit phaseã€‚

- **å¾ŒçºŒæ›´æ–°ï¼ˆUpdateï¼‰** ä¾ç„¶æ˜¯ render phase â†’ commit phaseã€‚

- å·®åˆ¥åªæ˜¯ **åˆæ¬¡æœƒå»ºç«‹æ•´æ£µ DOM**ï¼Œè€Œæ›´æ–°åªæœƒä¿®æ”¹æœ‰å·®ç•°çš„éƒ¨åˆ†ã€‚

---

## React Element èˆ‡ DOM Element çš„å·®åˆ¥

- **React element**ï¼šç”¨ä¾†æè¿° UI çš„ **JavaScript ç‰©ä»¶**ï¼Œå°±åƒè—åœ–ã€‚

  ```jsx
  const element = <div>Hello</div>;
  // React å…§éƒ¨æœƒè½‰æ›æˆï¼š
  {
    type: "div",
    props: { children: "Hello" }
  }
  ```

- **DOM element**ï¼šç€è¦½å™¨çœŸå¯¦çš„ç¯€é»ï¼Œä¾‹å¦‚ `<div>Hello</div>`ã€‚

ğŸ‘‰ React element æ˜¯ blueprintï¼ˆè¨­è¨ˆåœ–ï¼‰ï¼ŒDOM element æ‰æ˜¯æˆå“ã€‚

---

## setState ï¼šè§¸ç™¼ re-render çš„é‡è¦è§’è‰²

ç•¶å‘¼å« `setState`ï¼ˆä¾‹å¦‚ `setCount(count + 1)`ï¼‰æ™‚ï¼ŒReact æœƒå•Ÿå‹•ä»¥ä¸‹æµç¨‹ï¼š

1. **Render Phase**

   - React é‡æ–°åŸ·è¡Œ Function Componentï¼Œç”Ÿæˆæ–°çš„ React element treeã€‚

   - React é€²è¡Œ Virtual DOM diffï¼Œæ¯”å°æ–°èˆŠç¯€é»å·®ç•°ã€‚

2. **Commit Phase**

   - React æ›´æ–°çœŸå¯¦ DOM elementã€‚

   - ç•«é¢æ”¹è®Šã€‚

   - åŸ·è¡Œ `useEffect` callbackã€‚

---

## æµç¨‹åœ–

1. **ç¬¬ä¸€æ¬¡æ›è¼‰ï¼ˆMountï¼‰**

   - React å‘¼å« function component â†’ å»ºç«‹ React element treeï¼ˆrender phaseï¼‰ã€‚

   - React ç”¢ç”Ÿå°æ‡‰çš„ DOM element ä¸¦æ’å…¥é é¢ï¼ˆcommit phaseï¼‰ã€‚

   - åŸ·è¡Œ `useEffect(() => {...}, [])`ã€‚

2. **setState è§¸ç™¼æ›´æ–°**

   - å‘¼å« `setState` â†’ é€šçŸ¥ React æœ‰ç‹€æ…‹æ”¹è®Šã€‚

   - React é€²å…¥ render phaseï¼šé‡æ–°åŸ·è¡Œ function componentï¼Œç”Ÿæˆæ–°çš„ React elementã€‚

   - React æ¯”å°èˆŠçš„ virtual DOM å’Œæ–°çš„ virtual DOMã€‚

   - React é€²å…¥ commit phaseï¼šåªæ›´æ–°å¿…è¦çš„ DOM elementã€‚

   - åŸ·è¡Œå°æ‡‰çš„ `useEffect(() => {...}, [state])`ã€‚

3. **å¸è¼‰ï¼ˆUnmountï¼‰**

   - React ç§»é™¤ DOM elementã€‚

   - åŸ·è¡Œ `useEffect` çš„ cleanupï¼ˆreturn functionï¼‰

---

## ç¯„ä¾‹ç¨‹å¼ç¢¼ï¼šå®Œæ•´æµç¨‹è§€å¯Ÿ

```jsx
import { useState, useEffect } from "react";

export default function LifeCycleDemo() {
  const [count, setCount] = useState(0);

  console.log("Render Phaseï¼šåŸ·è¡Œ function componentï¼Œç”¢ç”Ÿ React element");

  // æ›è¼‰ (Mount) + æ›´æ–° (Update)
  useEffect(() => {
    console.log("Commit Phaseï¼šDOM å·²æ›´æ–°æˆ–åˆæ¬¡æ›è¼‰å®Œæˆ");

    return () => {
      console.log("Unmountï¼šåŸ·è¡Œ cleanupï¼Œå…ƒä»¶å³å°‡ç§»é™¤");
    };
  }, [count]);

  return (
    <div>
      <h2>React Function Component ç”Ÿå‘½é€±æœŸ Demo</h2>
      <p>ç›®å‰è¨ˆæ•¸ï¼š{count}</p>
      <button onClick={() => setCount(count + 1)}>+1</button>
    </div>
  );
}
```

---

## å¯¦éš›æµç¨‹èªªæ˜

### ç¬¬ä¸€æ¬¡æ›è¼‰ï¼ˆMountï¼‰

1. React å‘¼å« function component â†’ å»ºç«‹ React element treeï¼ˆ**Render Phase**ï¼‰ã€‚

2. React ç”¢ç”Ÿå°æ‡‰çš„ DOM element ä¸¦æ’å…¥é é¢ï¼ˆ**Commit Phase**ï¼‰ã€‚

3. åŸ·è¡Œ `useEffect(() => {...}, [])`ã€‚

Console è¼¸å‡ºï¼š

```bash
Render Phaseï¼šåŸ·è¡Œ function componentï¼Œç”¢ç”Ÿ React element
Commit Phaseï¼šDOM å·²æ›´æ–°æˆ–åˆæ¬¡æ›è¼‰å®Œæˆ
```

---

### setState è§¸ç™¼æ›´æ–°ï¼ˆUpdateï¼‰

1. å‘¼å« `setState` â†’ é€šçŸ¥ React æœ‰ç‹€æ…‹æ”¹è®Šã€‚

2. React é€²å…¥ **Render Phase**ï¼šé‡æ–°åŸ·è¡Œ function componentï¼Œç”Ÿæˆæ–°çš„ React elementã€‚

3. React æ¯”å°èˆŠçš„ Virtual DOM å’Œæ–°çš„ Virtual DOMï¼ˆReconciliationï¼‰ã€‚

4. React é€²å…¥ **Commit Phase**ï¼šåªæ›´æ–°å¿…è¦çš„ DOM elementã€‚

5. åŸ·è¡Œå°æ‡‰çš„ `useEffect(() => {...}, [state])`ã€‚

Console è¼¸å‡ºï¼š

```bash
Render Phaseï¼šåŸ·è¡Œ function componentï¼Œç”¢ç”Ÿ React element
Commit Phaseï¼šDOM å·²æ›´æ–°æˆ–åˆæ¬¡æ›è¼‰å®Œæˆ
```

---

### å¸è¼‰ï¼ˆUnmountï¼‰

1. React ç§»é™¤ DOM elementã€‚

2. åŸ·è¡Œ `useEffect` çš„ cleanupï¼ˆ`return function`ï¼‰ã€‚

Console è¼¸å‡ºï¼š

```bash
Unmountï¼šåŸ·è¡Œ cleanupï¼Œå…ƒä»¶å³å°‡ç§»é™¤
```

---

âœ… é€™å€‹ç¯„ä¾‹æœƒå®Œæ•´å‘ˆç¾ï¼š

- **Mount**ï¼ˆåˆæ¬¡æ›è¼‰ â†’ render phase + commit phaseï¼‰

- **Update**ï¼ˆsetState â†’ render phase + commit phaseï¼‰

- **Unmount**ï¼ˆç§»é™¤å…ƒä»¶ â†’ cleanupï¼‰

---

## ç¸½çµ

- **setState**ï¼šè§¸ç™¼ re-renderã€‚

- **Render Phase**ï¼šè¨ˆç®— UIï¼Œç”¢ç”Ÿæ–°çš„ React element treeã€‚

- **Commit Phase**ï¼šå¥—ç”¨å·®ç•°ï¼Œæ›´æ–° DOM elementï¼ŒåŸ·è¡Œå‰¯ä½œç”¨ã€‚

- **React element**ï¼šUI çš„è—åœ–ï¼ˆVirtual DOM ç¯€é»ï¼‰ã€‚

- **DOM element**ï¼šç€è¦½å™¨çœŸå¯¦çš„ç¯€é»ã€‚

ç†è§£é€™å€‹æµç¨‹å¾Œï¼Œä½ å°±èƒ½æ›´æ¸…æ¥šæŒæ¡ React çš„é‹ä½œæ©Ÿåˆ¶ï¼Œä¸¦åœ¨æ•ˆèƒ½å„ªåŒ–èˆ‡é™¤éŒ¯æ™‚æ›´æœ‰æ–¹å‘ã€‚
